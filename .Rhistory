library(ggplot2)
library(plyr)
setwd("~/crime")
arrestRaw <- read.csv("BPD_Arrests.csv")
arrestRaw$District <- as.factor(toupper(arrestRaw$District))
arrestRaw$District[arrestRaw$District == ""] <- NA
arrestRaw$ArrestDate <- as.character(arrestRaw$ArrestDate)
arrestRaw$ArrestDate <- as.Date(arrestRaw$ArrestDate, format = "%m/%d/%Y")
arrestRaw$ArrestMonth <- format(arrestRaw$ArrestDate, format = "%Y/%m")
crimeHist <- ggplot(data.frame(na.omit(arrestRaw)), aes(x = District)) +
geom_histogram(fill = "#0066FF") +
labs(title = "Arrests in Baltimore", x = "District", y = "Total") +
stat_bin(geom = "text", aes(label = ..count.., vjust = -1))
crimeHist
arrestMonthFreq <- as.data.frame(table(arrestRaw$ArrestMonth))
colnames(arrestMonthFreq) <- c("Date", "Total")
arrestMonthFreq$Date <- as.character(arrestMonthFreq$Date)
crimeMonth <- ggplot(arrestMonthFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests in Baltimore (Jan 2013 - June 2015)", x = "Month", y = "Total Monthly Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
crimeMonth
View(arrestRaw)
western <- arrestRaw[arrestRaw$District == "WESTERN"]
western <- arrestRaw[arrestRaw$District == "WESTERN", ]
View(western)
western <- na.omit(arrestRaw[arrestRaw$District == "WESTERN", ])
View(western)
eastern <- na.omit(arrestRaw[arrestRaw$District == "EASTERN", ])
str(arrestRaw$District)
unique(arrestRaw$District)
central <- na.omit(arrestRaw[arrestRaw$District == "CENTRAL", ])
northeastern <- na.omit(arrestRaw[arrestRaw$District == "NORTHEASTERN", ])
northwestern <- na.omit(arrestRaw[arrestRaw$District == "NORTHWESTERN", ])
southeastern <- na.omit(arrestRaw[arrestRaw$District == "SOUTHEASTERN", ])
southern <- na.omit(arrestRaw[arrestRaw$District == "SOUTHERN", ])
southwestern <- na.omit(arrestRaw[arrestRaw$District == "SOUTHWESTERN", ])
northern <- na.omit(arrestRaw[arrestRaw$District == "NORTHERN", ])
View(western)
westernFreq <- as.data.frame(table(western$ArrestMonth))
colnames(westernFreq) <- c("Date", "Total")
westernFreq$Date <- as.character(westernFreq$Date)
westernMonth <- ggplot(westernFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Western", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
westernMonth
easternFreq <- as.data.frame(table(eastern$ArrestMonth))
colnames(easternFreq) <- c("Date", "Total")
easternFreq$Date <- as.character(easternFreq$Date)
easternMonth <- ggplot(easternFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Eastern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
easternMonth
centralMonth <- ggplot(centralFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Central", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
centralFreq <- as.data.frame(table(central$ArrestMonth))
colnames(centralFreq) <- c("Date", "Total")
centralFreq$Date <- as.character(centralFreq$Date)
centralMonth <- ggplot(centralFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Central", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
centralMonth
northeasternFreq <- as.data.frame(table(northeastern$ArrestMonth))
colnames(northeasternFreq) <- c("Date", "Total")
northeasternFreq$Date <- as.character(northeasternFreq$Date)
northeasternMonth <- ggplot(centralFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Northeastern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
northeasternMonth
northeasternFreq <- as.data.frame(table(northeastern$ArrestMonth))
colnames(northeasternFreq) <- c("Date", "Total")
northeasternFreq$Date <- as.character(northeasternFreq$Date)
northeasternMonth <- ggplot(northeasternFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Northeastern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
northeasternMonth
northwesternFreq <- as.data.frame(table(northwestern$ArrestMonth))
colnames(northwesternFreq) <- c("Date", "Total")
northwesternFreq$Date <- as.character(northwesternFreq$Date)
northwesternMonth <- ggplot(northwesternFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Northwestern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
northwesternMonth
southeasternFreq <- as.data.frame(table(southeastern$ArrestMonth))
colnames(southeasternFreq) <- c("Date", "Total")
southeasternFreq$Date <- as.character(southeasternFreq$Date)
southeasternMonth <- ggplot(southeasternFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Southeastern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
southeasternMonth
southernFreq <- as.data.frame(table(southern$ArrestMonth))
colnames(southernFreq) <- c("Date", "Total")
southernFreq$Date <- as.character(southernFreq$Date)
southernMonth <- ggplot(southernFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Southern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
southernMonth
southwesternFreq <- as.data.frame(table(southwestern$ArrestMonth))
colnames(southwesternFreq) <- c("Date", "Total")
southwesternFreq$Date <- as.character(southwesternFreq$Date)
southwesternMonth <- ggplot(southwesternFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Southwestern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
southwesternMonth
northernFreq <- as.data.frame(table(northern$ArrestMonth))
colnames(northernFreq) <- c("Date", "Total")
northernFreq$Date <- as.character(northernFreq$Date)
northernMonth <- ggplot(northernFreq, aes(x = Date, y = Total)) +
geom_line(position = "identity", aes(group = 1)) +
labs(title = "Arrests by Month in the Northern", x = "Month", y = "Total Arrests") +
stat_smooth(method = "lm", se = TRUE, fill = "black", colour = "black", aes(group = 1))
northernMonth
library(gridExtra)
install.packages("gridExtra")
library(gridExtra)
grid.arrange(westernMonth, easternMonth, centralMonth, northeasternMonth, northwesternMonth, southeasternMonth,
southernMonth, southwesternMonth, northernMonth, ncol = 2)
grid.arrange(westernMonth, easternMonth, centralMonth, southernMonth, ncol = 2)
grid.arrange(northwesternMonth, northeasternMonth, southwesternMonth, southeasternMonth, ncol = 2)
grid.arrange(southernMonth, northernMonth, ncol = 1)
